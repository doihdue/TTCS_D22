<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMD - Hạt Dinh Dưỡng, Trái Cây Sấy, Nguyên Liệu Làm Bánh</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<!-- Import Header Fragment -->
<div th:replace="~{fragments/header :: header}"></div>

<!-- Hero Banner -->
<section class="hero-banner position-relative">
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="images/hat-min.webp" class="d-block w-100" alt="Hạt dinh dưỡng">
                <div class="carousel-caption text-center">
                    <h2 class="text-danger fw-bold">HẠT DINH DƯỠNG</h2>
                    <h3 class="text-white">DINH DƯỠNG TỪ THIÊN NHIÊN</h3>
                    <p class="text-white">- CHO CUỘC SỐNG CỦA BẠN -</p>
                    <p class="text-white">❤️ HEALTHY FOR LIFE ❤️</p>
                    <a th:href="@{/san-pham}" class="btn btn-primary mt-3">
                        <i class="fas fa-shopping-cart me-2"></i> Mua ngay
                    </a>
                </div>
            </div>
            <div class="carousel-item">
                <img src="images/nentraicay.jpg" class="d-block w-100" alt="Trái cây sấy">
                <div class="carousel-caption text-center">
                    <h2 class="text-danger fw-bold">TRÁI CÂY SẤY</h2>
                    <h3 class="text-white">HƯƠNG VỊ THIÊN NHIÊN</h3>
                    <p class="text-white">- THƯỞNG THỨC MỖI NGÀY -</p>
                    <p class="text-white">❤️ HEALTHY FOR LIFE ❤️</p>
                    <a th:href="@{/san-pham}" class="btn btn-primary mt-3">
                        <i class="fas fa-shopping-cart me-2"></i> Mua ngay
                    </a>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</section>

<!-- Product Categories -->
<section class="product-categories py-5">
    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center category-card">
                    <div class="card-body">
                        <h3 class="card-title">HẠT DINH DƯỠNG</h3>
                        <img src="images/hat.png" class="img-fluid my-3" alt="Hạt dinh dưỡng">
                        <p class="card-text">Các loại hạt dinh dưỡng tự nhiên, giàu protein, chất xơ và các vitamin thiết yếu.</p>
                        <a th:href="@{/san-pham1?category=Hạt Dinh Dưỡng}" class="btn btn-outline-primary">Xem thêm</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center category-card">
                    <div class="card-body">
                        <h3 class="card-title">TRÁI CÂY SẤY</h3>
                        <img src="images/dautaysaykho.jpg" class="img-fluid my-3" alt="Trái cây sấy">
                        <p class="card-text">Trái cây sấy giữ nguyên hương vị và dưỡng chất, thơm ngon và bổ dưỡng.</p>
                        <a th:href="@{/san-pham1?category=Trái Cây Sấy}" class="btn btn-outline-primary">Xem thêm</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center category-card">
                    <div class="card-body">
                        <h3 class="card-title">NGUYÊN LIỆU LÀM BÁNH</h3>
                        <img src="images/bot-lam-banh.jpg" class="img-fluid my-3" alt="Nguyên liệu làm bánh">
                        <p class="card-text">Nguyên liệu làm bánh chất lượng cao, đa dạng cho các loại bánh khác nhau.</p>
                        <a th:href="@{/san-pham1?category=Nguyên Liệu Làm Bánh}" class="btn btn-outline-primary">Xem thêm</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Products -->
<section class="featured-products py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-4">SẢN PHẨM NỔI BẬT</h2>
        <div class="row" th:if="${featuredProducts != null and !featuredProducts.isEmpty()}">
            <!-- Loop through featured products -->
            <div class="col-md-3 mb-4" th:each="product : ${featuredProducts}">
                <div class="card product-card h-100">
                    <img th:src="${product.linkImage}" class="card-img-top" th:alt="${product.productName}">
                    <div class="card-body text-center">
                        <h5 class="card-title" th:text="${product.productName}">Hạt Hạnh Nhân Mỹ</h5>
                        <p class="card-text text-danger fw-bold"
                           th:text="${#numbers.formatDecimal(product.price, 0, 'POINT', 0, 'COMMA')} + 'đ'">180.000đ</p>
                        <a th:href="@{/product/{id}(id=${product.productID})}" class="btn btn-sm btn-outline-primary">Chi tiết</a>
                        <!-- Nút thêm vào giỏ đã sửa -->
                        <form th:action="@{/add-to-cart}" method="post" class="d-inline">
                            <input type="hidden" name="productId" th:value="${product.productID}">
                            <input type="hidden" name="quantity" value="1">
                            <button type="submit" class="btn btn-sm btn-primary">
                                <i class="fas fa-shopping-cart"></i> Thêm vào giỏ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" th:if="${featuredProducts == null or featuredProducts.isEmpty()}">
            <p class="text-center">Hiện chưa có sản phẩm nổi bật nào.</p>
        </div>
        <div class="text-center mt-4">
            <a th:href="@{/san-pham}" class="btn btn-primary">Xem tất cả sản phẩm</a>
            <!-- Changed from /product/san-pham to /product/san-pham1 based on your controller -->
        </div>
    </div>
</section>

<!-- Why Choose Us -->
<section class="why-choose-us py-5">
    <div class="container">
        <h2 class="text-center mb-5">TẠI SAO CHỌN DMD?</h2>
        <div class="row">
            <div class="col-md-3 mb-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-leaf fa-3x text-primary mb-3"></i>
                    <h4>Sản Phẩm Tự Nhiên</h4>
                    <p>Chúng tôi cung cấp các sản phẩm tự nhiên, không chất bảo quản, đảm bảo dinh dưỡng.</p>
                </div>
            </div>
            <div class="col-md-3 mb-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-shipping-fast fa-3x text-primary mb-3"></i>
                    <h4>Giao Hàng Nhanh Chóng</h4>
                    <p>Giao hàng nhanh chóng trong vòng 24h đối với khu vực nội thành TP.HN.</p>
                </div>
            </div>
            <div class="col-md-3 mb-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-medal fa-3x text-primary mb-3"></i>
                    <h4>Chất Lượng Đảm Bảo</h4>
                    <p>Cam kết chất lượng sản phẩm, đổi trả trong vòng 7 ngày nếu không hài lòng.</p>
                </div>
            </div>
            <div class="col-md-3 mb-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-headset fa-3x text-primary mb-3"></i>
                    <h4>Hỗ Trợ 24/7</h4>
                    <p>Đội ngũ tư vấn viên luôn sẵn sàng hỗ trợ bạn mọi lúc mọi nơi.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Testimonials -->
<section class="testimonials py-5">
    <div class="container">
        <h2 class="text-center mb-5">KHÁCH HÀNG NÓI GÌ VỀ CHÚNG TÔI</h2>
        <div class="row" th:if="${testimonials != null and !testimonials.isEmpty()}">
            <!-- Lặp qua danh sách đánh giá -->
            <div class="col-md-4 mb-4" th:each="rev : ${testimonials}"> <!-- Đổi tên biến lặp thành 'rev' cho rõ ràng hơn là review entity -->
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <!-- Giữ ảnh placeholder, hoặc thay bằng ảnh avatar động nếu có -->
                            <div class="rounded-circle me-3 bg-secondary d-flex align-items-center justify-content-center"
                                 style="width: 50px; height: 50px; font-size: 1.5rem;"> <!-- Thêm style cho kích thước và căn giữa icon -->
                                <i class="fas fa-user text-white"></i> <!-- Icon người dùng của Font Awesome -->
                            </div>
                            <div>
                                <!-- Hiển thị tên người dùng từ fname và lname -->
                                <h5 class="mb-0" th:text="${rev.user.fname + ' ' + rev.user.lname}">Tên Khách Hàng</h5>
                                <div class="text-warning">
                                    <!-- Hiển thị sao dựa trên rev.vote (kiểu double) -->
                                    <!-- Cần làm tròn hoặc ép kiểu vote sang integer để so sánh với i -->
                                    <th:block th:each="i : ${#numbers.sequence(1, 5)}">
                                        <i th:if="${rev.vote != null and i <= rev.vote.intValue()}" class="fas fa-star"></i> <!-- Sao đầy -->
                                        <i th:if="${rev.vote == null or i > rev.vote.intValue()}" class="far fa-star"></i>  <!-- Sao rỗng -->
                                    </th:block>
                                </div>
                            </div>
                        </div>
                        <!-- Hiển thị nội dung bình luận từ trường 'review' -->
                        <p class="card-text" th:text="${rev.review}">"Nội dung bình luận..."</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Hiển thị nếu không có đánh giá -->
        <div class="row" th:if="${testimonials == null or testimonials.isEmpty()}">
            <p class="text-center">Chưa có đánh giá nào.</p>
        </div>
    </div>
</section>

<!-- Import Footer Fragment -->
<div th:replace="~{fragments/footer :: footer}"></div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/script.js}"></script>

<!-- Import Header Script -->
<div th:replace="~{fragments/header :: header-script}"></div>

</body>
</html>